<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chinese New Year 2026 ‚Äî Zodiac Sequence</title>
<meta name="description" content="Animated sequence of the 12 Chinese zodiacs, finishing with Year of the Horse ‚Äî 2026. Includes dragon with fire moving anti-clockwise around the stage." />
<style>
  :root{
    --bg1:#4a000a; --bg2:#150006; --gold:#f6d36a; --gold2:#ffec9f; --text:#fff8e7;
    --muted:#ffd9a0;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--text);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
    background:
      radial-gradient(1200px 800px at 80% -10%, #c4001f33, transparent 60%),
      radial-gradient(1200px 800px at 10% 110%, #8a001633, transparent 60%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
    overflow:hidden;
  }
  .wrap{
    position:relative; min-height:100%;
    display:grid; grid-template-rows:auto 1fr auto;
    align-items:center; justify-items:center; padding:24px;
  }
  .heading{
    text-align:center; letter-spacing:.5px; text-transform:uppercase; font-weight:700;
    font-size:clamp(12px,1.8vw,18px); color:var(--gold2);
    padding:6px 12px; border:1px solid var(--gold2); border-radius:999px;
    background: linear-gradient(90deg, #b30 0%, #d11 50%, #b30 100%);
    box-shadow: 0 0 0 2px #00000040 inset, 0 8px 24px #00000055;
  }

  /* Stage */
  .stage{
    position:relative; width:min(92vw, 780px); aspect-ratio:16/9;
    border-radius:24px; border:1px solid #ffffff1a; overflow:hidden;
    background:
      radial-gradient(800px 500px at 50% -10%, #ffd59717, transparent 70%),
      linear-gradient(180deg, #6a000f, #2a0008 56%, #1a0005);
    box-shadow: 0 40px 60px #00000080, 0 0 0 2px #00000040 inset, 0 0 0 1px #ffffff12 inset;
    display:grid; place-items:center; padding:clamp(8px,2vw,18px);
  }
  .stage::before{
    content:""; position:absolute; inset:0; pointer-events:none;
    background:
      linear-gradient(45deg, transparent 47%, #ffd27a15 48%, #ffd27a15 52%, transparent 53%),
      linear-gradient(-45deg, transparent 47%, #ffd27a15 48%, #ffd27a15 52%, transparent 53%);
    background-size: 30px 30px;
  }

  /* Tiny control (sound) */
  .controls{
    position:absolute; top:10px; right:10px; z-index:20;
    display:flex; gap:8px;
  }
  .btn{
    display:inline-block; padding:8px 12px; font-weight:800; letter-spacing:.3px;
    color:#3b0505; background: linear-gradient(180deg, #ffd66b, #ffbf3d);
    border:1px solid #f2b53c; border-radius:999px; cursor:pointer; user-select:none;
    box-shadow: 0 3px 0 #c98b21, 0 6px 12px #0007; transition: transform .08s ease;
    font-size:12px;
  }
  .btn:active{ transform: translateY(1px) }

  /* Zodiac stack */
  .zodiac{ position:relative; display:grid; gap:clamp(8px,2.2vw,14px); place-items:center; text-align:center; }
  .emoji{ font-size:clamp(64px,18vw,180px); line-height:1; filter:drop-shadow(0 14px 22px #0008); }
  .label{ font-size:clamp(18px,3.2vw,28px); font-weight:700; letter-spacing:.6px; text-shadow:0 2px 0 #0008, 0 0 24px #ffea; color:var(--gold2) }
  .progress{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:clamp(8px,1.5vw,14px) }
  .dot{ width:12px; height:12px; border-radius:50%; background:#ffffff22; outline:1px solid #ffffff24; box-shadow:0 0 0 1px #000 inset; transition:.3s }
  .dot.active{ background: radial-gradient(circle at 30% 30%, #fff 0 30%, var(--gold) 31% 100%); box-shadow:0 0 12px 2px #ffeb99aa, 0 0 0 1px #000 inset; transform:scale(1.2) }

  /* Final card */
  .final{ position:absolute; inset:0; display:grid; place-items:center; text-align:center;
          background: radial-gradient(1200px 800px at 50% 100%, #9c000f55, transparent 60%);
          opacity:0; pointer-events:none; z-index:10; }
  .final.show{ opacity:1; pointer-events:auto; transition:opacity .8s ease .2s; }
  .final .year{
font-size:clamp(28px,6vw,68px); font-weight:900; color:var(--gold2);
    letter-spacing:1px; text-shadow:0 3px 0 #0008, 0 0 22px #fff6; margin-bottom:.1em;
  }
  .final .horse{ font-size:clamp(100px,23vw,240px); filter:drop-shadow(0 18px 30px #000a); animation:gentle 4s ease-in-out infinite; }
  .final .msg{ font-size:clamp(14px,2.2vw,20px); color:var(--muted); margin-top:.2rem; }
  .final .replay{ margin-top:14px }

  /* Dragon & fire layer */
  #dragon, #fireLayer{ position:absolute; inset:0; pointer-events:none; }
  #dragon .sprite{
    position:absolute; transform:translate(-50%,-50%);
    font-size:clamp(28px,6vw,42px); filter:drop-shadow(0 8px 14px #000c);
  }
  .fire{
    position:absolute; transform:translate(-50%,-50%);
    font-size:clamp(16px,4.3vw,26px); opacity:0.95;
    animation: fireRise 900ms ease-out forwards;
    will-change: transform, opacity;
  }
  @keyframes fireRise{
    0%{ transform:translate(-50%,-50%) scale(.7); opacity:0 }
    40%{ opacity:1 }
    100%{ transform:translate(-50%,-90%) scale(1.1) rotate(-6deg); opacity:0 }
  }

  /* Confetti */
  canvas#confetti{ position:absolute; inset:0; width:100%; height:100%; pointer-events:none; opacity:.95; mix-blend-mode:screen; z-index:9 }

  /* Motion */
  @keyframes popIn{
    0%{opacity:0; transform: translateY(14px) scale(.8) rotateX(12deg)}
    60%{opacity:1; transform: translateY(-4px) scale(1.05) rotateX(0)}
    100%{opacity:1; transform: translateY(0) scale(1) rotateX(0)}
  }
  @keyframes gentle{ 0%,100%{ transform: translateY(0) rotate(-2deg) } 50%{ transform: translateY(-6px) rotate(2deg) } }
  .enter{ animation: popIn .65s cubic-bezier(.2,.8,.2,1) both; }

  @media (prefers-reduced-motion: reduce){
    .enter, .final .horse{ animation:none !important }
    #dragon, #fireLayer, canvas#confetti{ display:none }
  }

  footer{ opacity:.9; font-size:12px; color:#ffefc9; text-align:center; margin-top:10px; }
  a, a:visited{ color:#ffd87e; }
</style>
</head>
<body>
  <div class="wrap">
    <div class="heading">Chinese New Year ‚Ä¢ Zodiac Sequence</div>

    <section class="stage" id="stage" aria-label="Chinese zodiac animation stage">
      <!-- Small control -->
      <div class="controls">
        <button class="btn" id="soundToggle" aria-pressed="false" aria-label="Toggle sound">üîà Sound</button>
      </div>

      <!-- Dragon + fire path -->
      <div id="fireLayer" aria-hidden="true"></div>
      <div id="dragon" aria-hidden="true"><div class="sprite" id="dragonSprite">üê≤</div></div>

      <!-- Confetti -->
      <canvas id="confetti" aria-hidden="true"></canvas>

      <!-- Main zodiac view -->
      <div class="zodiac" aria-live="polite" aria-atomic="true">
        <div id="emoji" class="emoji" role="img" aria-label="Rat">üê≠</div>
        <div id="label" class="label">Rat</div>
        <div class="progress" id="progress"></div>
      </div>

      <!-- Final screen (2026 ABOVE the horse) -->
      <div id="final" class="final" aria-hidden="true">
        <div>
          <div class="year">2026</div>
          <div class="horse" role="img" aria-label="Horse">üê¥</div>
          <div class="msg">Year of the Horse ‚Äî Wishing you strength, energy, and fresh beginnings.</div>
          <button class="btn replay" id="replay" aria-label="Replay animation">‚Üª Replay</button>
        </div>
      </div>
    </section>

    <footer>Paste this as <strong>index.html</strong> in your GitHub repo and open your GitHub Pages URL.</footer>
  </div>

<script>
/* ======== Tunables ======== */
const ITEM_DURATION_MS = 1000;          // time each zodiac is shown
const PAUSE_BETWEEN_MS = 250;           // gap between items
const SHOW_FINAL_FIREWORKS_MS = 6000;   // confetti duration
const DRAGON_SPEED_PX_S = 120;          // dragon speed along the rectangle
const FIRE_SPAWN_EVERY_MS = 160;        // how often to drop üî•
const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

/* ======== Grab DOM ======== */
const emojiEl = document.getElementById('emoji');
const labelEl = document.getElementById('label');
const progressEl = document.getElementById('progress');
const finalEl = document.getElementById('final');
const replayBtn = document.getElementById('replay');
const confettiCanvas = document.getElementById('confetti');
const soundToggle = document.getElementById('soundToggle');
const dragonSprite = document.getElementById('dragonSprite');
const fireLayer = document.getElementById('fireLayer');
const stage = document.getElementById('stage');
const ctx = confettiCanvas.getContext && confettiCanvas.getContext('2d');

/* ======== Data ======== */
const zodiacs = [
  { name: 'Rat',    emoji: 'üê≠' },
  { name: 'Ox',     emoji: 'üêÆ' },
  { name: 'Tiger',  emoji: 'üêØ' },
  { name: 'Rabbit', emoji: 'üê∞' },
  { name: 'Dragon', emoji: 'üê≤' },
  { name: 'Snake',  emoji: 'üêç' },
  { name: 'Horse',  emoji: 'üê¥' },
  { name: 'Goat',   emoji: 'üêê' },
  { name: 'Monkey', emoji: 'üêµ' },
  { name: 'Rooster',emoji: 'üêî' },
  { name: 'Dog',    emoji: 'üê∂' },
  { name: 'Pig',    emoji: 'üê∑' }
];

/* ======== Progress dots ======== */
const dots = [];
zodiacs.forEach((_, i) => {
  const d = document.createElement('div');
  d.className = 'dot';
  d.setAttribute('aria-label', `Step ${i+1}: ${zodiacs[i].name}`);
  progressEl.appendChild(d);
  dots.push(d);
});

function setStage(item, index){
  emojiEl.textContent = item.emoji;
  labelEl.textContent = item.name;
  emojiEl.setAttribute('aria-label', item.name);
  emojiEl.classList.remove('enter'); labelEl.classList.remove('enter');
  void emojiEl.offsetWidth; // restart animation
  emojiEl.classList.add('enter'); labelEl.classList.add('enter');
  dots.forEach((d,i)=> d.classList.toggle('active', i === index));
}

/* ======== Canvas sizing ======== */
function sizeCanvas(){
  if(!ctx) return;
  const r = confettiCanvas.getBoundingClientRect();
  const dpr = window.devicePixelRatio || 1;
  confettiCanvas.width = Math.max(1, Math.round(r.width * dpr));
  confettiCanvas.height = Math.max(1, Math.round(r.height * dpr));
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
window.addEventListener('resize', sizeCanvas, {passive:true});

/* ======== Confetti ======== */
function runConfetti(ms){
  if (!ctx || prefersReducedMotion) return;
  sizeCanvas();
  const dpr = window.devicePixelRatio || 1;
  const W = (confettiCanvas.width || 0) / dpr;
  const H = (confettiCanvas.height || 0) / dpr;

  const colors = ['#fff7cc','#ffe08a','#ffd166','#ff9f1c','#ff6b6b','#ffd27a','#ffec9f'];
  const pieces = Array.from({length: 160}, ()=> ({
    x: Math.random()*W, y: -20 - Math.random()*H*0.4,
    w: 6 + Math.random()*6, h: 10 + Math.random()*12,
    vy: 1 + Math.random()*2.4, vx: -1 + Math.random()*2,
    rot: Math.random()*Math.PI*2, vr: -0.2 + Math.random()*0.4,
    color: colors[Math.floor(Math.random()*colors.length)], swing: Math.random()*1.2, life: 0
  }));

  let start = performance.now();
  function tick(t){
    const elapsed = t - start;
    ctx.clearRect(0,0,W,H);
    for(const p of pieces){
      p.life += 1; p.vx += Math.sin((p.life + p.swing)*0.05)*0.02;
      p.x += p.vx; p.y += p.vy; p.rot += p.vr;
      if(p.y > H + 18){ p.y = -18; p.x = Math.random()*W; } // wrap
      ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.rot);
      ctx.fillStyle = p.color; ctx.globalAlpha = 0.9;
      ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
      ctx.restore();
    }
    if (elapsed < ms){ requestAnimationFrame(tick); } else { ctx.clearRect(0,0,W,H); }
  }
  requestAnimationFrame(tick);
}

/* ======== Dragon path (anti-clockwise) ======== */
let dragonRunning = false, dragonRAF = 0, lastFire = 0;
function getRectPathCCW(){
  const pad = 12;
  const r = stage.getBoundingClientRect();
  const x0 = pad, y0 = pad;
  const x1 = Math.max(pad+1, r.width - pad), y1 = Math.max(pad+1, r.height - pad);
  const pts = [ {x:x1,y:y0}, {x:x0,y:y0}, {x:x0,y:y1}, {x:x1,y:y1}, {x:x1,y:y0} ]; // anti-clockwise
  const segs = []; let total = 0;
  for (let i=0;i<pts.length-1;i++){
    const a=pts[i], b=pts[i+1]; const len = Math.hypot(b.x-a.x, b.y-a.y);
    segs.push({a,b,len}); total+=len;
  }
  return {segs,total};
}

function animateDragon(){
if (prefersReducedMotion) return;
  dragonRunning = true;
  let t0 = performance.now();
  let path = getRectPathCCW();
  let dist = 0;
  const speed = DRAGON_SPEED_PX_S;

  function step(t){
    if (!dragonRunning) return;
    const dt = (t - t0) / 1000; t0 = t;
    dist += speed * dt; let d = path.total ? (dist % path.total) : 0;

    // find segment
    let acc = 0, seg = path.segs[0];
    for (const s of path.segs){
      if (d <= acc + s.len){ seg = s; d -= acc; break; }
      acc += s.len;
    }
    const f = seg.len ? Math.max(0, Math.min(1, d / seg.len)) : 0;
    const x = seg.a.x + (seg.b.x - seg.a.x)*f;
    const y = seg.a.y + (seg.b.y - seg.a.y)*f;
    const angle = Math.atan2(seg.b.y - seg.a.y, seg.b.x - seg.a.x);

    dragonSprite.style.left = x + 'px';
    dragonSprite.style.top  = y + 'px';
    dragonSprite.style.transform = translate(-50%,-50%) rotate(${angle}rad);

    if (t - lastFire > FIRE_SPAWN_EVERY_MS){
      lastFire = t;
      const flame = document.createElement('div');
      flame.className = 'fire';
      flame.textContent = 'üî•';
      flame.style.left = x + 'px';
      flame.style.top  = y + 'px';
      fireLayer.appendChild(flame);
      setTimeout(()=> flame.remove(), 1000);
    }

    dragonRAF = requestAnimationFrame(step);
  }
  dragonRAF = requestAnimationFrame(step);

  // Recompute path on resize
  window.addEventListener('resize', () => { path = getRectPathCCW(); }, {passive:true});
}

/* ======== Audio (off until you tap) ======== */
let audioCtx = null, masterGain = null, toneTimer = 0, audioOn = false;
function startAudio(){
  if (!audioOn) return;
  try{
    audioCtx = audioCtx  new (window.AudioContext  window.webkitAudioContext)();
    if (!masterGain){
      masterGain = audioCtx.createGain();
      masterGain.gain.value = 0.06;
      masterGain.connect(audioCtx.destination);
    }
    if (audioCtx.state === 'suspended') audioCtx.resume();
    const scale = [0,2,4,7,9]; const baseFreq = 392; let step = 0;
    clearInterval(toneTimer);
    toneTimer = setInterval(()=>{
      if (!audioCtx || audioCtx.state === 'suspended') return;
      const idx = scale[step % scale.length];
      const freq = baseFreq * Math.pow(2, idx/12);
      const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
      o.type='sine'; o.frequency.value=freq;
      g.gain.setValueAtTime(0.0001, audioCtx.currentTime);
      g.gain.exponentialRampToValueAtTime(1, audioCtx.currentTime + 0.02);
      g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.28);
      o.connect(g).connect(masterGain); o.start(); o.stop(audioCtx.currentTime + 0.3);
      if (step % 8 === 0){
        const o2 = audioCtx.createOscillator(); const g2 = audioCtx.createGain();
        o2.type='sine'; o2.frequency.value=freq/2;
        g2.gain.setValueAtTime(0.0001, audioCtx.currentTime);
        g2.gain.exponentialRampToValueAtTime(1, audioCtx.currentTime + 0.02);
        g2.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.4);
        o2.connect(g2).connect(masterGain); o2.start(); o2.stop(audioCtx.currentTime + 0.42);
      }
      step++;
    }, 360);
  }catch(e){ console.warn('Audio failed:', e); }
}
function stopAudio(){
  clearInterval(toneTimer);
  if (audioCtx && audioCtx.state !== 'closed') audioCtx.suspend();
}

soundToggle.addEventListener('click', () => {
  audioOn = !audioOn;
  soundToggle.setAttribute('aria-pressed', String(audioOn));
  soundToggle.textContent = audioOn ? 'üîä Sound' : 'üîà Sound';
  if (audioOn) startAudio(); else stopAudio();
});

/* ======== Main sequence ======== */
let running = false;
async function playSequence(){
  if (running) return;
  running = true;
  finalEl.classList.remove('show');
  finalEl.setAttribute('aria-hidden','true');

  for (let i = 0; i < zodiacs.length; i++){
    setStage(zodiacs[i], i);
    await new Promise(r => setTimeout(r, ITEM_DURATION_MS));
    if (i < zodiacs.length - 1) await new Promise(r => setTimeout(r, PAUSE_BETWEEN_MS));
  }

  // Ensure we end explicitly on Horse
  const horseIndex = zodiacs.findIndex(z => z.
name === 'Horse');
  setStage(zodiacs[horseIndex], horseIndex);

  requestAnimationFrame(()=>{
    finalEl.classList.add('show');
    finalEl.setAttribute('aria-hidden','false');
    runConfetti(SHOW_FINAL_FIREWORKS_MS);
  });

  running = false;
}

/* ======== Kick off automatically ======== */
window.addEventListener('load', () => {
  sizeCanvas();
  animateDragon();
  playSequence();   // auto-start (no play button needed)
});
replayBtn.addEventListener('click', playSequence);
</script>
</body>
</html>
